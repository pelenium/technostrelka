import _defineProperty from"@babel/runtime/helpers/defineProperty";function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}import React from"react";import LockOutline from"@scaleflex/icons/lock-outline";import UnlockOutline from"@scaleflex/icons/unlock-outline";import{Reset}from"@scaleflex/icons";import{SET_RESIZE,ZOOM_CANVAS}from"../../../actions";import{useStore}from"../../../hooks";import getProperDimensions from"../../../utils/getProperDimensions";import getSizeAfterRotation from"../../../utils/getSizeAfterRotation";import getZoomFitFactor from"../../../utils/getZoomFitFactor";import restrictNumber from"../../../utils/restrictNumber";import{DEFAULT_ZOOM_FACTOR}from"../../../utils/constants";import{StyledResizeWrapper,StyledResizeInput,StyledRatioLockIcon,StyledResetButton}from"./Resize.styled";var Resize=function(a){var b=a.onChange,c=a.currentSize,d=a.hideResetButton,e=a.alignment,f=a.disableWrap,g=useStore(),h=g.dispatch,i=g.originalImage,j=g.resize,k=g.shownImageDimensions,l=g.adjustments,m=l.crop,n=l.rotation,o=void 0===n?0:n,p=g.theme,q=g.t,r=function(a){var d,e=a.target,f=e.name,g=e.value;if(!(1>parseFloat(g))){var l=Math.min(10*i.width,10*i.height),n=getSizeAfterRotation(i.width,i.height,o),p=_defineProperty({},f,g?restrictNumber(g,0,l):g),q="height"===f,r=q?"width":"height",s=null!==(d=c.ratioUnlocked)&&void 0!==d?d:j.ratioUnlocked;if(!s){var t=n.width/n.height;p[r]=q?Math.round(p[f]*t):Math.round(p[f]/t)}if(p[f]!==j[f]||p[r]!==j[r]){if("function"==typeof b)return void b(p);h({type:SET_RESIZE,payload:p});var u=m.width&&m.height&&m||k,v=_objectSpread(_objectSpread({},j),p);h({type:ZOOM_CANVAS,payload:{factor:v.width&&v.height?getZoomFitFactor(u,v):DEFAULT_ZOOM_FACTOR,isAbsoluteZoom:!0}})}}},s="undefined"==typeof j.width&&"undefined"==typeof j.height||i.width===j.width&&i.height===j.height,t=getProperDimensions((c.width||c.height)&&c||j,m,k,i,o),u=j.manualChangeDisabled,v="undefined"!=typeof j.width&&!j.width,w="undefined"!=typeof j.height&&!j.height;return React.createElement(StyledResizeWrapper,{className:"FIE_resize-tool-options",alignment:e,disableWrap:f},React.createElement(StyledResizeInput,{className:"FIE_resize-width-option",value:v?"":t.width,name:"width",onChange:u?void 0:r,inputMode:"numeric",title:q("resizeWidthTitle"),label:q("width"),inputProps:{type:"number"},size:"sm",iconEnd:"px",placeholder:"Width",disableWrap:f,disabled:u}),React.createElement(StyledRatioLockIcon,{className:"FIE_resize-ratio-locker",title:q("toggleRatioLockTitle"),onClick:u?void 0:function toggleRatioLock(){return"function"==typeof b?void b({ratioUnlocked:!c.ratioUnlocked}):void h({type:SET_RESIZE,payload:{ratioUnlocked:!j.ratioUnlocked}})},color:"basic",size:"sm",disabled:u},c.ratioUnlocked||j.ratioUnlocked?React.createElement(UnlockOutline,{size:16,color:p.palette.success}):React.createElement(LockOutline,{size:16,color:p.palette.error})),React.createElement(StyledResizeInput,{className:"FIE_resize-height-option",value:w?"":t.height,name:"height",onChange:u?void 0:r,inputMode:"numeric",title:q("resizeHeightTitle"),label:q("height"),inputProps:{type:"number"},size:"sm",iconEnd:"px",placeholder:"Height",disableWrap:f,disabled:u}),!d&&React.createElement(StyledResetButton,{className:"FIE_resize-reset-button",size:"sm",color:"basic",onClick:s||u?void 0:function resetResize(){h({type:SET_RESIZE,payload:{width:void 0,height:void 0,ratioUnlocked:!1}});var a=m.width&&m.height&&m||k;h({type:ZOOM_CANVAS,payload:{factor:getZoomFitFactor(a,a)}})},disabled:s||u},React.createElement(Reset,null)))};Resize.defaultProps={onChange:void 0,currentSize:{},hideResetButton:!1,alignment:"center",disableWrap:!1};export default Resize;